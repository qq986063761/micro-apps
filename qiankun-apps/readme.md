# å¾®å‰ç«¯ç®¡ç†ç³»ç»Ÿ Demo

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Vue2 + qiankun** çš„å¾®å‰ç«¯æ¶æ„æ¼”ç¤ºé¡¹ç›®ï¼Œå±•ç¤ºäº†ç°ä»£å¾®å‰ç«¯æ¶æ„çš„æ ¸å¿ƒç‰¹æ€§ï¼šè·¯ç”±åˆ‡æ¢ã€æ ·å¼éš”ç¦»ã€çŠ¶æ€ç®¡ç†å’Œåº”ç”¨é—´é€šä¿¡ã€‚

## ğŸš€ é¡¹ç›®ç‰¹æ€§

- **å¾®å‰ç«¯æ¶æ„**: åŸºäº qiankun 2.10.16 å®ç°
- **Vue2 æŠ€æœ¯æ ˆ**: ä½¿ç”¨ Vue 2.6.14 + Vue Router + Vuex
- **æ ·å¼éš”ç¦»**: æ¯ä¸ªå­åº”ç”¨ç‹¬ç«‹çš„æ ·å¼ä½œç”¨åŸŸ
- **åº”ç”¨é—´é€šä¿¡**: å…¨å±€çŠ¶æ€ç®¡ç†å’Œäº‹ä»¶ä¼ é€’
- **è·¯ç”±ç®¡ç†**: ä¸»åº”ç”¨è·¯ç”± + å­åº”ç”¨ç‹¬ç«‹è·¯ç”±
- **ä¸»é¢˜åˆ‡æ¢**: æ”¯æŒæµ…è‰²/æ·±è‰²ä¸»é¢˜åˆ‡æ¢
- **å“åº”å¼è®¾è®¡**: ç°ä»£åŒ–çš„ UI è®¾è®¡

## ğŸ“ é¡¹ç›®ç»“æ„

```
qiankun-apps/
â”œâ”€â”€ main/                    # ä¸»åº”ç”¨ (ç«¯å£: 8080)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/          # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ HomeView.vue        # é¦–é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ MicroAppView.vue    # å¾®åº”ç”¨å®¹å™¨
â”‚   â”‚   â”‚   â””â”€â”€ AboutView.vue       # å…³äºé¡µé¢
â”‚   â”‚   â”œâ”€â”€ router/         # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ store/          # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ micro-apps.js   # å¾®åº”ç”¨ç®¡ç†
â”‚   â”‚   â””â”€â”€ main.js         # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ vue.config.js       # æ„å»ºé…ç½®
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ child1/                 # å­åº”ç”¨1 - ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ (ç«¯å£: 8081)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/          # ç”¨æˆ·ç®¡ç†é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ UserList.vue        # ç”¨æˆ·åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ UserProfile.vue     # ä¸ªäººèµ„æ–™
â”‚   â”‚   â”‚   â””â”€â”€ UserSettings.vue    # ç³»ç»Ÿè®¾ç½®
â”‚   â”‚   â”œâ”€â”€ router/         # å­åº”ç”¨è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ store/          # å­åº”ç”¨çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ public-path.js  # å…¬å…±è·¯å¾„é…ç½®
â”‚   â”‚   â””â”€â”€ main.js         # å­åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ vue.config.js       # æ„å»ºé…ç½®
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ child2/                 # å­åº”ç”¨2 - å•†å“ç®¡ç†ç³»ç»Ÿ (ç«¯å£: 8082)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/          # å•†å“ç®¡ç†é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductList.vue     # å•†å“åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductCategory.vue # åˆ†ç±»ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductOrders.vue   # è®¢å•ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ ProductAnalytics.vue # æ•°æ®åˆ†æ
â”‚   â”‚   â”œâ”€â”€ router/         # å­åº”ç”¨è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ store/          # å­åº”ç”¨çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ public-path.js  # å…¬å…±è·¯å¾„é…ç½®
â”‚   â”‚   â””â”€â”€ main.js         # å­åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ vue.config.js       # æ„å»ºé…ç½®
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ start.bat              # Windows å¯åŠ¨è„šæœ¬
â”œâ”€â”€ start.sh               # Linux/Mac å¯åŠ¨è„šæœ¬
â”œâ”€â”€ package.json           # æ ¹ç›®å½•é…ç½®
â””â”€â”€ readme.md              # é¡¹ç›®æ–‡æ¡£
```

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### ä¸»åº”ç”¨ (Main App) - ç«¯å£: 8080
- **å¾®åº”ç”¨ç®¡ç†**: æ³¨å†Œå’Œç®¡ç†å­åº”ç”¨
- **å…¨å±€çŠ¶æ€ç®¡ç†**: ç”¨æˆ·ä¿¡æ¯ã€ä¸»é¢˜ã€è¯­è¨€ç­‰å…¨å±€çŠ¶æ€
- **åº”ç”¨é—´é€šä¿¡**: é€šè¿‡ qiankun çš„ initGlobalState å®ç°
- **ä¸»é¢˜åˆ‡æ¢**: æ”¯æŒæµ…è‰²/æ·±è‰²ä¸»é¢˜åˆ‡æ¢
- **è·¯ç”±ç®¡ç†**: ä¸»åº”ç”¨è·¯ç”± + å­åº”ç”¨è·¯ç”±é›†æˆ
- **ç³»ç»Ÿè®¾ç½®**: ç»Ÿä¸€çš„ç³»ç»Ÿé…ç½®ç®¡ç†

### å­åº”ç”¨1 (Child1) - ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ - ç«¯å£: 8081
- **ç”¨æˆ·åˆ—è¡¨**: ç”¨æˆ·ä¿¡æ¯çš„å¢åˆ æ”¹æŸ¥
- **ä¸ªäººèµ„æ–™**: ç”¨æˆ·ä¸ªäººèµ„æ–™ç®¡ç†
- **ç³»ç»Ÿè®¾ç½®**: ä¸»é¢˜ã€é€šçŸ¥ç­‰ä¸ªæ€§åŒ–è®¾ç½®
- **æƒé™ç®¡ç†**: ç”¨æˆ·è§’è‰²å’Œæƒé™æ§åˆ¶
- **æ•°æ®ç»Ÿè®¡**: ç”¨æˆ·æ•°é‡ç»Ÿè®¡å’ŒçŠ¶æ€å±•ç¤º

### å­åº”ç”¨2 (Child2) - å•†å“ç®¡ç†ç³»ç»Ÿ - ç«¯å£: 8082
- **å•†å“åˆ—è¡¨**: å•†å“ä¿¡æ¯çš„å¢åˆ æ”¹æŸ¥
- **åˆ†ç±»ç®¡ç†**: å•†å“åˆ†ç±»çš„åˆ›å»ºå’Œç®¡ç†
- **è®¢å•ç®¡ç†**: è®¢å•çŠ¶æ€è·Ÿè¸ªå’Œå¤„ç†
- **æ•°æ®åˆ†æ**: é”€å”®æ•°æ®ç»Ÿè®¡å’Œå¯è§†åŒ–
- **åº“å­˜ç®¡ç†**: åº“å­˜é¢„è­¦å’Œè¡¥è´§æé†’

## ğŸ›  æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Vue 2.6.14
- **å¾®å‰ç«¯æ¡†æ¶**: qiankun 2.10.16
- **è·¯ç”±ç®¡ç†**: Vue Router 3.5.1
- **çŠ¶æ€ç®¡ç†**: Vuex 3.6.2
- **æ„å»ºå·¥å…·**: Vue CLI 5.0.0
- **æ ·å¼å¤„ç†**: SCSS + CSS3
- **å¼€å‘å·¥å…·**: concurrently (å¹¶å‘å¯åŠ¨)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ (æ¨è)

**Windows ç”¨æˆ·:**
```bash
# åŒå‡»è¿è¡Œ start.bat æ–‡ä»¶
# æˆ–åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ
start.bat
```

**Linux/Mac ç”¨æˆ·:**
```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x start.sh
# è¿è¡Œè„šæœ¬
./start.sh
```

### æ–¹æ³•äºŒï¼šä½¿ç”¨ npm å‘½ä»¤

```bash
# 1. å®‰è£…æ‰€æœ‰åº”ç”¨çš„ä¾èµ–
npm run install:all

# 2. åŒæ—¶å¯åŠ¨æ‰€æœ‰åº”ç”¨
npm run start:all

# æˆ–è€…åˆ†åˆ«å¯åŠ¨
npm run start:main    # å¯åŠ¨ä¸»åº”ç”¨ (ç«¯å£: 8080)
npm run start:child1  # å¯åŠ¨å­åº”ç”¨1 (ç«¯å£: 8081)
npm run start:child2  # å¯åŠ¨å­åº”ç”¨2 (ç«¯å£: 8082)
```

### 3. è®¿é—®åº”ç”¨

- **ä¸»åº”ç”¨**: http://localhost:8080 (å¾®å‰ç«¯é›†æˆè®¿é—®)
- **å­åº”ç”¨1**: http://localhost:8081 (ç‹¬ç«‹è®¿é—®)
- **å­åº”ç”¨2**: http://localhost:8082 (ç‹¬ç«‹è®¿é—®)

> ğŸ’¡ **æç¤º**: å»ºè®®é€šè¿‡ä¸»åº”ç”¨è®¿é—®ï¼Œä½“éªŒå®Œæ•´çš„å¾®å‰ç«¯åŠŸèƒ½

## ğŸ”§ å¾®å‰ç«¯ç‰¹æ€§

### 1. åº”ç”¨éš”ç¦»
- **æ ·å¼éš”ç¦»**: æ¯ä¸ªå­åº”ç”¨éƒ½æœ‰ç‹¬ç«‹çš„æ ·å¼ä½œç”¨åŸŸï¼Œé¿å…æ ·å¼å†²çª
- **JavaScript æ²™ç®±**: qiankun æä¾› JS æ²™ç®±æœºåˆ¶ï¼Œé¿å…å…¨å±€å˜é‡æ±¡æŸ“
- **ç‹¬ç«‹è¿è¡Œ**: æ¯ä¸ªå­åº”ç”¨éƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²
- **èµ„æºéš”ç¦»**: é™æ€èµ„æºã€API è¯·æ±‚ç­‰å®Œå…¨éš”ç¦»

### 2. åº”ç”¨é—´é€šä¿¡
- **å…¨å±€çŠ¶æ€ç®¡ç†**: ä½¿ç”¨ qiankun çš„ `initGlobalState` å®ç°åº”ç”¨é—´çŠ¶æ€å…±äº«
- **äº‹ä»¶é€šä¿¡**: æ”¯æŒåº”ç”¨é—´äº‹ä»¶ä¼ é€’å’Œç›‘å¬
- **Props ä¼ é€’**: ä¸»åº”ç”¨å¯ä»¥å‘å­åº”ç”¨ä¼ é€’æ•°æ®å’Œé…ç½®
- **å®æ—¶åŒæ­¥**: çŠ¶æ€å˜åŒ–å®æ—¶åŒæ­¥åˆ°æ‰€æœ‰ç›¸å…³åº”ç”¨

### 3. è·¯ç”±ç®¡ç†
- **ä¸»åº”ç”¨è·¯ç”±**: è´Ÿè´£æ•´ä½“è·¯ç”±ç®¡ç†å’Œå­åº”ç”¨åˆ‡æ¢
- **å­åº”ç”¨è·¯ç”±**: æ¯ä¸ªå­åº”ç”¨æœ‰ç‹¬ç«‹çš„è·¯ç”±ç³»ç»Ÿ
- **è·¯ç”±åŒæ­¥**: æ”¯æŒæµè§ˆå™¨å‰è¿›åé€€ï¼ŒURL çŠ¶æ€åŒæ­¥
- **åŠ¨æ€è·¯ç”±**: æ”¯æŒåŠ¨æ€æ³¨å†Œå’Œå¸è½½å­åº”ç”¨è·¯ç”±

### 4. ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **bootstrap**: åº”ç”¨å¯åŠ¨å‰çš„åˆå§‹åŒ–
- **mount**: åº”ç”¨æŒ‚è½½åˆ° DOM å®¹å™¨
- **unmount**: åº”ç”¨å¸è½½å’Œèµ„æºæ¸…ç†
- **update**: åº”ç”¨æ›´æ–°æ—¶çš„å¤„ç†é€»è¾‘

## ğŸ“– å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„å­åº”ç”¨

1. **åˆ›å»ºå­åº”ç”¨ç›®å½•ç»“æ„**
```bash
mkdir new-child-app
cd new-child-app
vue create . --preset default
```

2. **é…ç½®å­åº”ç”¨**
   - ä¿®æ”¹ `package.json` ä¸­çš„ name å­—æ®µ
   - é…ç½® `vue.config.js` è®¾ç½®ç«¯å£å’Œ webpack è¾“å‡º
   - åˆ›å»º `public-path.js` æ–‡ä»¶

3. **å®ç°ç”Ÿå‘½å‘¨æœŸå‡½æ•°**
```javascript
// main.js
import './public-path'

let instance = null

function render(props = {}) {
  const { container } = props
  instance = new Vue({
    router,
    store,
    render: h => h(App)
  }).$mount(container ? container.querySelector('#app') : '#app')
}

export async function bootstrap() {
  console.log('[new-child-app] vue app bootstraped')
}

export async function mount(props) {
  console.log('[new-child-app] props from main framework', props)
  render(props)
}

export async function unmount() {
  instance.$destroy()
  instance.$el.innerHTML = ''
  instance = null
}
```

4. **åœ¨ä¸»åº”ç”¨ä¸­æ³¨å†Œ**
```javascript
// main/src/micro-apps.js
registerMicroApps([
  {
    name: 'new-child-app',
    entry: '//localhost:8083',
    container: '#subapp-viewport',
    activeRule: '/new-app',
    props: {
      data: actions.getGlobalState(),
      actions: actions
    }
  }
])
```

### åº”ç”¨é—´é€šä¿¡ç¤ºä¾‹

```javascript
// ä¸»åº”ç”¨ä¸­åˆå§‹åŒ–å…¨å±€çŠ¶æ€
const actions = initGlobalState({
  user: { name: 'Admin', role: 'administrator' },
  theme: 'light',
  language: 'zh-CN'
})

// å­åº”ç”¨ä¸­ç›‘å¬çŠ¶æ€å˜åŒ–
actions.onGlobalStateChange((state, prev) => {
  console.log('çŠ¶æ€å˜åŒ–:', state, prev)
  // å¤„ç†çŠ¶æ€å˜åŒ–é€»è¾‘
})

// å­åº”ç”¨ä¸­æ›´æ–°çŠ¶æ€
actions.setGlobalState({
  theme: 'dark',
  lastUpdate: new Date().toISOString()
})
```

### æ ·å¼éš”ç¦»

æ¯ä¸ªå­åº”ç”¨ä½¿ç”¨ç‹¬ç«‹çš„ CSS ç±»åå‰ç¼€ï¼Œé¿å…æ ·å¼å†²çªï¼š

```css
/* å­åº”ç”¨1 - ç”¨æˆ·ç®¡ç† */
.child1-app {
  /* ç”¨æˆ·ç®¡ç†ç›¸å…³æ ·å¼ */
}

/* å­åº”ç”¨2 - å•†å“ç®¡ç† */
.child2-app {
  /* å•†å“ç®¡ç†ç›¸å…³æ ·å¼ */
}
```

## ğŸš€ æ„å»ºéƒ¨ç½²

### å¼€å‘ç¯å¢ƒæ„å»º

```bash
# æ„å»ºæ‰€æœ‰åº”ç”¨
npm run build:all

# åˆ†åˆ«æ„å»º
npm run build:main    # æ„å»ºä¸»åº”ç”¨
npm run build:child1  # æ„å»ºå­åº”ç”¨1
npm run build:child2  # æ„å»ºå­åº”ç”¨2
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **æ„å»ºæ‰€æœ‰åº”ç”¨**
```bash
npm run build:all
```

2. **éƒ¨ç½²åˆ°æœåŠ¡å™¨**
   - å°† `main/dist` éƒ¨ç½²åˆ°ä¸»åº”ç”¨æœåŠ¡å™¨
   - å°† `child1/dist` éƒ¨ç½²åˆ°å­åº”ç”¨1æœåŠ¡å™¨
   - å°† `child2/dist` éƒ¨ç½²åˆ°å­åº”ç”¨2æœåŠ¡å™¨

3. **é…ç½®æœåŠ¡å™¨è·¯ç”±**
```nginx
# nginx é…ç½®ç¤ºä¾‹
server {
    listen 80;
    server_name your-domain.com;
    
    # ä¸»åº”ç”¨
    location / {
        root /path/to/main/dist;
        try_files $uri $uri/ /index.html;
    }
    
    # å­åº”ç”¨1
    location /user {
        root /path/to/main/dist;
        try_files $uri $uri/ /index.html;
    }
    
    # å­åº”ç”¨2
    location /product {
        root /path/to/main/dist;
        try_files $uri $uri/ /index.html;
    }
}
```

## â“ å¸¸è§é—®é¢˜

### Q: å­åº”ç”¨æ— æ³•åŠ è½½ï¼Ÿ
**A:** æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
- å­åº”ç”¨æ˜¯å¦æ­£å¸¸å¯åŠ¨
- ç«¯å£é…ç½®æ˜¯å¦æ­£ç¡®
- CORS é…ç½®æ˜¯å¦æ­£ç¡®
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

### Q: æ ·å¼å†²çªæ€ä¹ˆåŠï¼Ÿ
**A:** è§£å†³æ–¹æ¡ˆï¼š
- ç¡®ä¿æ¯ä¸ªå­åº”ç”¨ä½¿ç”¨ç‹¬ç«‹çš„ CSS ç±»åå‰ç¼€
- ä½¿ç”¨ CSS Modules æˆ– styled-components
- é…ç½® qiankun çš„ strictStyleIsolation

### Q: å¦‚ä½•è°ƒè¯•å­åº”ç”¨ï¼Ÿ
**A:** è°ƒè¯•æ–¹æ³•ï¼š
- ç‹¬ç«‹å¯åŠ¨å­åº”ç”¨è¿›è¡Œè°ƒè¯•
- ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·
- æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—å’Œç½‘ç»œè¯·æ±‚

### Q: åº”ç”¨é—´é€šä¿¡ä¸ç”Ÿæ•ˆï¼Ÿ
**A:** æ£€æŸ¥ï¼š
- å…¨å±€çŠ¶æ€æ˜¯å¦æ­£ç¡®åˆå§‹åŒ–
- å­åº”ç”¨æ˜¯å¦æ­£ç¡®ç›‘å¬çŠ¶æ€å˜åŒ–
- çŠ¶æ€æ›´æ–°æ–¹æ³•æ˜¯å¦æ­£ç¡®è°ƒç”¨

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ Issue: [GitHub Issues](https://github.com/your-username/qiankun-micro-frontend-demo/issues)
- é‚®ç®±: your-email@example.com

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Star æ”¯æŒä¸€ä¸‹ï¼
